# gcc컴파일러에 대해

## gcc 동작과정의 이해
gcc : 원래는 GNU C Compiler를 의미했으나, 1999년 부터 GNU Compiler Collection

gcc 가 실행시키는 프로그램
cpp : [전처리기]
cc1 : [컴파일러]
as  : [어셈블러]
id  : [링커]

1. 전처리 단계
> 소스 파일(file.c) 에 gcc를 동작시키면 가장 먼저 전처리기인 cpp가 동작. cpp는 소스파일의 #include 와 #define 같은 #으로 시작하는 전처리기 부분을 처리한다. 즉 헤더파일을 삽입하고 실행 문자의 매크로를 상수로 변환한다. 소스 파일이 전처리기를 거치면 file.i 라는 이름의 파일이 생성되지만 디스크에 저장되지는 않는다.

2. 컴파일 단계
> 컴파일러가 전처리된 파일(file.i)로 부터 어셈블리어로 된 파일(file.s)을 생성한다. 일반적으로 다음 단계인 어셈블 단계를 바로 실행하기 때문에 디스크에 저장되지는 않는다.

3. 어셈블 단계
> 어셈블리어로 된 파일(file.s)을 기계가 직접 이해할 수 있는 기계어로 된 오브젝트 파일 (file.o)로 변환한다.

4. 링크 단계
> 오브젝트 파일(file.o)은 printf, scanf와 같은 라이브러리 함수에 해당하는 코드가 없기 때문에 실행될 수 없다. 여러 파일로 이루어진 프로그램의 경우도 파일 간 연결이 이루어지지 않아 실행될 수 없는데, 이러한 라이브러리 함수와 오브젝트 파일들을 연결해 실행 파일을 생성하는 단계가 링크단계다.

5. 파일 확장자에 따른 처리 방법.
gcc는 파일 확장자에 따라 다음과 같이 처리 방법을 달리하는데, 한 가지만 설명하자면 확장자가 .c인 경우 gcc로 전처리기, 컴파일, 어셈블, 링크 과정을 거쳐야 실행 파일이 완성된다는 것이다.

|확장자|종류|처리방법|
|:--|:--|:--|
|.c|C 소스 파일| 전처리, 컴파일, 어셈블, 링크|
|.C .CC| C++ 소스 파일| 전처리, 컴파일, 어셈블, 링크|
|.i| 전처리된 C파일| 컴파일, 어셈블, 링크|
|.ii| 전처리된 C++파일| 컴파일, 어셈블, 링크|
|.s|어셈블리어로 된 파일| 어셈블, 링크|
|.S|어셈블리어로 된 파일| 전처리, 어셈블, 링크|
|.o|오브젝트 파일|링크|
|.a .so| 컴파일된 라이브러리 파일| 링크|

## gcc 실행하기

```
$ gcc 소스파일 이름
```

## 옵션
옵션	의미
-E	전처리를 실행하고 컴파일을 중단하게 한다.
-c	소스 파일을 컴파일만 하고 링크를 수행하지 않으며, 오브젝트 파일을 생성한다.
-o	바이너리 형식의 출력 파일 이름을 지정하는데, 지정하지 않으면 a.out라는 기본 이름이 적용된다.
-I	헤더 파일을 검색하는 디렉토리 목록을 추가한다.
-L	라이브러리 파일을 검색하는 디렉토리 목록을 추가한다.
-l	라이브러리 파일을 컴파일 시 링크한다.
-g	바이너리 파일에 표준 디버깅 정보를 포함시킨다.
-ggdb	바이너리 파일에 GNU 디버거인 gdb만이 이해할 수 있는 많은 디버깅 정보를 포함시킨다.
-O	컴파일 코드를 최적화시킨다.
-ON	최적화 N 단계를 지정한다.
-DFOO=RAR	명령라인에서 BAR의 값을 가지는 FOO라는 선행 처리기 매크로를 정의한다.
-static	정적 라이브러리에 링크한다.
-ansi	표준과 충돌하는 GNU 확장안을 취소하며, ANSI/ISO C 표준을 지원한다. 이 옵션은 ANSI 호환 코드를 보장하지 않는다.
-traditional	과서 스타일의 함수 정의 형식과 같이 전통적인 K&R(Kernighan and Ritchie) C 언어 형식을 지원한다.
-MM	make 호환의 의존성 목록을 출력한다.
-V	컴파일의 각 단계에서 사용되는 명령어를 보여준다.
 